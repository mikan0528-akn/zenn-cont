---
title: "Discordã®botã‚’å¸¸æ™‚èµ·å‹•ã•ã›ã‚‹"
emoji: "ğŸ“Ÿ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Discord,ä»®æƒ³ãƒã‚·ãƒ³]
published: true
---

:::message
Ubuntu22.04LTSã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
botã¯Node.jsã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
:::
ã“ã‚“ã«ã¡ã¯ã€ä¼¼é³¥ã§ã™ï¼
ä»Šå›ã¯ã€systedã‚’ä½¿ç”¨ã—ã¦botã‚’å¸¸æ™‚èµ·å‹•ã•ã›ã‚‹æ–¹æ³•ã‚’å‚™å¿˜éŒ²ã‚‚å…¼ã­ã¦æ›¸ã„ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼
# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹
hoge.serviceã‚’/etc/systemd/systemã«ä½œæˆã—ã¾ã™ï¼
(ãƒ‘ã‚¹ã¯/etc/systemd/system/hoge.service)
ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„
ã€Œhogeã€ã¯ã‚µãƒ¼ãƒ“ã‚¹åã€ã€Œhogekunã€ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼åã§ã™ã€‚
ã€ŒWorkingDirectoryã€ã¯å®Ÿè¡Œã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
ã€ŒExecStartã€ã¯1ã¤ç›®ã¯Node.jsã®ãƒ‘ã‚¹ã€2ã¤ç›®ã¯botã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
ç·¨é›†ã™ã‚‹å¿…è¦ã®ã‚ã‚‹ç®‡æ‰€ã«â—ã‚’ä»˜ã‘ã¦ã‚ã‚Šã¾ã™
```a:hoge.service
[Unit]
Description= Node.js hoge #â—

[Service]
Type=simple
User=hogekun #â—
WorkingDirectory=/home/hogekun/botkun #â—
ExecStart=/bin/node /home/hogekun/botkun/index.js #â—
ExecStop=/usr/bin/pkill -e node
Restart=always
RestartSec=2
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=hoge #â—

[Install]
WantedBy=multi-user.target
```

# Systemdã¸ã®ç™»éŒ²ç­‰
1. ãƒ•ã‚¡ã‚¤ãƒ«ãŒèªè­˜ã•ã‚Œã¦ã„ã‚‹ã‹ã®ç¢ºèª
```bash
systemctl list-unit-files --type=service | grep hoge
```
2. èµ·å‹•ã™ã‚‹
```bash
systemctl start hoge.service
```
3. çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹
```bash
systemctl status hoge.service
```
4. è‡ªå‹•èµ·å‹•ã‚’æœ‰åŠ¹ã«ã™ã‚‹
```bash
systemctl enable hoge.service
```

# ãŠã‚ã‚Šã«
ä»¥ä¸ŠãŒsystemdã‚’ä½¿ç”¨ã—ã¦botã‚’å¸¸æ™‚èµ·å‹•ã•ã›ã‚‹æ–¹æ³•ã§ã™ï¼
ã“ã‚Œä»¥å¤–ã«ã‚‚ã„ã‚ã„ã‚ãªæ–¹æ³•ãŒã‚ã‚‹ã®ã§ã€ãœã²èª¿ã¹ã¦ã¿ã¦ãã ã•ã„ï¼